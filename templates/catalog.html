{% extends 'index.html' %}

{% set active_page = 'catalog' %}

{% block styles %}
  {{ super() }}
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/catalog.css') }}" />
{% endblock %}

{% block scripts %}
  {{super()}}
  <script type="application/javascript" src="{{url_for('static', filename='js/catalog.js')}}"></script>
{% endblock %}

{% block content %}
  {% include 'navbar.html' %}
  <div class="container-fluid">
    <div class="panel-group" id="accordion">
      {% for group in groups %}
        <div class="panel panel-info">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" href="#{{ group.name }}">
                {% if group.name == 'api' %}
                  <span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span> {{ _('API (Programmierschnittstellen)') }}
                {% elif group.name == 'application' %}
                  <span class="glyphicon glyphicon-phone" aria-hidden="true"></span> {{ _('Anwendungen') }}
                {% elif group.name == 'documentation' %}
                  <span class="glyphicon glyphicon-book" aria-hidden="true"></span> {{ _('Dokumentationen') }}
                {% elif group.name == 'download' %}
                  <span class="glyphicon glyphicon-download" aria-hidden="true"></span> {{ _('Downloads') }}
                {% elif group.name == 'external' %}
                  <span class="glyphicon glyphicon-link" aria-hidden="true"></span> {{ _('externe Links') }}
                {% elif group.name == 'geoservice' %}
                  <span class="glyphicon glyphicon-globe" aria-hidden="true"></span> {{ _('Geodatendienste') }}
                {% elif group.name == 'helper' %}
                  <span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> {{ _('Tools') }}
                {% else %}
                  <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> {{ group.name }}
                {% endif %}
              </a>
            </h4>
          </div>
          <div id="{{ group.name }}" class="panel-collapse collapse">
            <div class="panel-body">
              {% if group.name == 'documentation' %}
                <div class="list-group">
                  {% for documentation_link in documentation_links %}
                    <a href="{{ documentation_link.link }}" target="_blank" class="list-group-item list-group-item-action">
                      <span class="glyphicon glyphicon-{% if documentation_link.reachable == True %}ok-sign green{% else %}remove-sign red{% endif %}" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{{ _('letzte Prüfung auf Erreichbarkeit') }}: {{ documentation_link.reachable_last_check|datetime_l10n('full') }}"></span>
                      <span class="glyphicon glyphicon-eye-{% if documentation_link.public == True %}open green{% else %}close red{% endif %}" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{% if documentation_link.public == True %}{{ _('öffentlich zugänglich') }}{% else %}{{ _('nicht öffentlich zugänglich') }}{% endif %}"></span>
                      {{ documentation_link.title }}
                    </a>
                  {% endfor %}
                </div>
              {% endif %}
              {% if group.name == 'download' %}
                <div class="list-group">
                  {% for download_link in download_links %}
                    <a href="{{ download_link.link }}" target="_blank" class="list-group-item list-group-item-action">
                      <span class="glyphicon glyphicon-{% if download_link.reachable == True %}ok-sign green{% else %}remove-sign red{% endif %}" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{{ _('letzte Prüfung auf Erreichbarkeit') }}: {{ download_link.reachable_last_check|datetime_l10n('full') }}"></span>
                      <span class="glyphicon glyphicon-eye-{% if download_link.public == True %}open green{% else %}close red{% endif %}" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{% if download_link.public == True %}{{ _('öffentlich zugänglich') }}{% else %}{{ _('nicht öffentlich zugänglich') }}{% endif %}"></span>
                      {{ download_link.title }}
                    </a>
                  {% endfor %}
                </div>
              {% endif %}
              {% if group.name == 'external' %}
                <span class="glyphicon glyphicon-filter" aria-hidden="true"></span> <input class="filter-input" id="external-filter-input" placeholder="{{ _('Freitextfilter') }}…" type="text" />
                {% for external_tag in external_tags %}
                  <h5{% if loop.first %} class="first"{% endif %}>{{ external_tag.title }}</h5>
                  <div class="external-list-group">
                    {% for external_link in external_tag.id|get_tag_links() %}
                      <a href="{{ external_link.link }}" target="_blank" class="list-group-item list-group-item-action">
                        <span class="glyphicon glyphicon-{% if external_link.reachable == True %}ok-sign green{% else %}remove-sign red{% endif %}" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{{ _('letzte Prüfung auf Erreichbarkeit') }}: {{ external_link.reachable_last_check|datetime_l10n('full') }}"></span>
                        <span class="glyphicon glyphicon-eye-{% if external_link.public == True %}open green{% else %}close red{% endif %}" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{% if external_link.public == True %}{{ _('öffentlich zugänglich') }}{% else %}{{ _('nicht öffentlich zugänglich') }}{% endif %}"></span>
                        {{ external_link.title }}
                      </a>
                    {% endfor %}
                  </div>
                {% endfor %}
              {% endif %}
              {% if group.name == 'geoservice' %}
                <div class="checkboxes" id="geoservice-checkboxes">
                  <span class="glyphicon glyphicon-filter" aria-hidden="true"></span>
                  {% for geoservice_tag in geoservice_tags %}
                    <label class="checkbox-inline">
                      <input type="checkbox" class="geoservice-checkbox" id="geoservice-checkbox-{{ geoservice_tag.id }}" value="{{ geoservice_tag.title }}" checked="checked" /> {{ geoservice_tag.title }}
                    </label>
                  {% endfor %}
                </div>
                <span class="glyphicon glyphicon-filter" aria-hidden="true"></span> <input class="filter-input" id="geoservice-filter-input" placeholder="{{ _('Freitextfilter') }}…" type="text" />
                <div class="panel-group" id="geoservice-accordion">
                  {% for geoservice_link in geoservice_links %}
                    {% if geoservice_link.parent_id == geoservice_link.id %}
                      <div class="panel panel-info">
                        <div class="panel-heading">
                          <h4 class="panel-title">
                            <a data-toggle="collapse" href="#geoservice-{{ geoservice_link.id }}">
                              <span class="full-width">{{ geoservice_link.title }}</span>
                              <small>
                              {% for typifier_tag in geoservice_link.id|get_link_children_typifier_tags(True) %}
                                <span class="full-width geoservice-typifier-tag">{{ typifier_tag }}</span>
                              {% endfor %}
                              </small>
                            </a>
                          </h4>
                        </div>
                        <div id="geoservice-{{ geoservice_link.id }}" class="panel-collapse collapse">
                          <div class="panel-body">
                            {% set link_children_tags = geoservice_link.id|get_link_children_tags(True) %}
                            {% if link_children_tags|length > 0 %}
                              <h5 class="first"><span class="glyphicon glyphicon-tag" aria-hidden="true"></span> {{ _('Schlagworte/Tags/Keywords') }}</h5>
                              <span class="full-width">
                                {% for tag in link_children_tags %}
                                    {{ tag }}{% if not loop.last %} •{% endif %}
                                {% endfor %}
                              </span>
                            {% endif %}
                            {% for child in geoservice_link.id|get_link_children(True) %}
                              <div class="geoservice-child">
                                {% set typifier_tag = child.id|get_link_typifier_tag(True) %}
                                <h5 {% if link_children_tags|length == 0 %}class="first"{% endif %}><span class="glyphicon glyphicon-globe" aria-hidden="true"></span> {{ typifier_tag }}</h5>
                                {% if 'inspire' in typifier_tag|lower and child.inspire_annex_theme != None %}
                                  <span class="full-width"><span class="glyphicon glyphicon-flag" aria-hidden="true"></span> {{ _('Annex-Thema') }}</span>
                                  <span class="full-width">{{ child.inspire_annex_theme }}</span>
                                {% endif %}
                                <span class="full-width"><span class="glyphicon glyphicon-comment" aria-hidden="true"></span> {{ _('Beschreibung') }}</span>
                                <span class="full-width">{{ child.description }}</span>
                                {% set metadata_sublink = child.id|get_link_metadata_sublink() %}
                                {% if metadata_sublink != None %}
                                  <span class="full-width"><span class="glyphicon glyphicon-paperclip" aria-hidden="true"></span> {{ _('Metadaten') }}</span>
                                  <a href="{{ metadata_sublink.link }}" target="_blank">
                                    <span class="glyphicon glyphicon-{% if metadata_sublink.reachable == True %}ok-sign green{% else %}remove-sign red{% endif %}" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{{ _('letzte Prüfung auf Erreichbarkeit') }}: {{ metadata_sublink.reachable_last_check|datetime_l10n('full') }}"></span>
                                    <span class="glyphicon glyphicon-eye-{% if metadata_sublink.public == True %}open green{% else %}close red{% endif %}" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{% if metadata_sublink.public == True %}{{ _('öffentlich zugänglich') }}{% else %}{{ _('nicht öffentlich zugänglich') }}{% endif %}"></span>
                                    {{ metadata_sublink.title }}
                                  </a>
                                {% endif %}
                                <span class="full-width"><span class="glyphicon glyphicon-link" aria-hidden="true"></span> {{ _('Link') }}</span>
                                <a href="{{ child.link }}" target="_blank">
                                  <span class="glyphicon glyphicon-{% if child.reachable == True %}ok-sign green{% else %}remove-sign red{% endif %}" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{{ _('letzte Prüfung auf Erreichbarkeit') }}: {{ child.reachable_last_check|datetime_l10n('full') }}"></span>
                                  <span class="glyphicon glyphicon-eye-{% if child.public == True %}open green{% else %}close red{% endif %}" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{% if child.public == True %}{{ _('öffentlich zugänglich') }}{% else %}{{ _('nicht öffentlich zugänglich') }}{% endif %}"></span>
                                  {{ child.link }}
                                </a>
                              </div>
                            {% endfor %}
                            {% if geoservice_link.date != None or geoservice_link.authorship_place != None or geoservice_link.authorship_name != None or geoservice_link.authorship_mail != None or geoservice_link.data_link != None %}
                              <h5><span class="glyphicon glyphicon-home" aria-hidden="true"></span> {{ _('Datenquelle') }}</h5>
                              {% if geoservice_link.date != None %}
                                <span class="full-width"><span class="glyphicon glyphicon-time" aria-hidden="true"></span> {{ _('Stand') }}</span>
                                <span class="full-width">{{ geoservice_link.date|date_l10n('full') }}</span>
                              {% endif %}
                              {% if geoservice_link.authorship_place != None or geoservice_link.authorship_name != None or geoservice_link.authorship_mail != None %}
                                <span class="full-width"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> {{ ngettext('Autor', 'Autoren', geoservice_link.authorship_place|length) }}</span>
                                {% for authorship_place in geoservice_link.authorship_place %}
                                  <span class="full-width">
                                    {% if geoservice_link.authorship_name[loop.index0] != None %}
                                      {{ geoservice_link.authorship_name[loop.index0] }}
                                      {% if geoservice_link.authorship_mail[loop.index0] != None %}
                                        <a href="mailto:{{ geoservice_link.authorship_mail[loop.index0] }}"><span class="glyphicon glyphicon-envelope" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{{ _('Kontakt') }}"></span></a>
                                      {% endif %}
                                      •
                                    {% endif %}
                                    {{ authorship_place }}
                                  </span>
                                {% endfor %}
                              {% endif %}
                              {% set opendata_sublink = geoservice_link.id|get_link_opendata_sublink() %}
                              {% if opendata_sublink != None %}
                                <span class="full-width"><span class="glyphicon glyphicon-link" aria-hidden="true"></span> {{ _('Link') }}</span>
                                <a href="{{ opendata_sublink.link }}" target="_blank">
                                  <span class="glyphicon glyphicon-{% if opendata_sublink.reachable == True %}ok-sign green{% else %}remove-sign red{% endif %}" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{{ _('letzte Prüfung auf Erreichbarkeit') }}: {{ opendata_sublink.reachable_last_check|datetime_l10n('full') }}"></span>
                                  <span class="glyphicon glyphicon-eye-{% if opendata_sublink.public == True %}open green{% else %}close red{% endif %}" aria-hidden="true" data-toggle="tooltip" data-placement="right" title="{% if opendata_sublink.public == True %}{{ _('öffentlich zugänglich') }}{% else %}{{ _('nicht öffentlich zugänglich') }}{% endif %}"></span>
                                  {{ opendata_sublink.title }}
                                </a>
                              {% endif %}
                            {% endif %}
                          </div>
                        </div>
                      </div>
                    {% endif %}
                  {% endfor %}
                </div>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
  {% include 'footer.html' %}
{% endblock %}
